---
title: "HW 06 Part 2: Wrangling"
author: "Madison Hongsermeier-Baxter"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

```{r}
library(tidyverse)
library(knitr)
install.packages("smatr")
library(smatr)
```

# darters

```{r}
file_path <- "~/Documents/BI485/hongsermeier-baxter_madison/data"
dat <- read.delim(file.path(file_path, "darters.txt"))
```

```{r}
start_pos <- c(1, 4, 15, 16, 17, 18, 21, 25, 29, 33, 36, 39, 40)
stop_pos <- c(3, 14, 15, 16, 17, 20, 24, 28, 32, 35, 38, 40, 41)
names <- c("specimen id", "species", "riffle", "age", "sex", "length", "depth", "velocity", "temperature", "majsub", "minsub", "majtype", "mintype")
darters <- read_fwf(file.path(file_path, "darters.txt"), fwf_positions(start_pos, stop_pos, col_names = names), skip = 15)
```

```{r}
darters
```

Use filter() to remove tetrazonum and zonale.

```{r}
darters2 <- darters %>%
  filter(!species %in% c("zonale", "tetrazonum"))
darters2
```

Sum together the majsub and minsub into a new column called total_substrate. Does total_substrate sum to 1 for all observations?

Yes, total_substrate sums to 1 for all observations.
```{r}
mutate(darters2,
  total_substrate = majsub + minsub
)
```

Change the riffle values of 1 and 2 to Riffle 1 and Riffle 2.
```{r}
darters2$riffle[darters2$riffle==1] <- "Riffle_1"
darters2$riffle[darters2$riffle==2] <- "Riffle_2"
darters2
```

Change the length data from centimeters to millimeters. It is more common to use mm for small fishes.
```{r}
darters2 <- mutate(darters2,
       length = length * 10)
```

```{r}
darters2
```

Change the sex values of f and m to Female and Male.
```{r}
darters2$sex[darters2$sex=="f"] <- "Female"
darters2$sex[darters2$sex=="m"] <- "Male"
darters2
```

Use group_by() and summarize() to summarize the mean length, depth, and velocity for each species for each riffle. Make a table with the summary means.

```{r}
darters_means <- darters2 %>% group_by(species) %>%
  summarise_at(.vars = vars(length, depth, velocity), 
               .funs = c(mean = "mean")) 
darters_means
```

Plot 1
Make a plot that uses the stat_summary() technique but use x = species and y = length. Add a geom_point() layer to add the mean length of each species to the plot. Use a filled square shape. You will have to use the summarized data set to get the mean for this geom.

```{r}
ggplot(data = darters2) +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  ) +
  geom_point(data=darters_means, mapping = aes(x = species, y = length_mean), shape = 15)
```

Turn the plot so that the species are listed on the left axis and length on bottom axis
```{r}
ggplot(data = darters2) +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  ) +
  geom_point(data=darters_means, mapping = aes(x = species, y = length_mean), shape = 15) +
  coord_flip()
```

Add facet_wrap() to separate the two riffles.
```{r}
ggplot(data = darters2) +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  ) +
  geom_point(data=darters_means, mapping = aes(x = species, y = length_mean), shape = 15) +
  coord_flip() +
  facet_wrap(~ riffle, nrow = 2)
```

Add labs() so that length includes the appropriate unit of measurement in parentheses and that the species axis is not labeled (x = NULL).
```{r}
ggplot(data = darters2) +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  ) +
  geom_point(data=darters_means, mapping = aes(x = species, y = length_mean), shape = 15) +
  coord_flip() +
  facet_wrap(~ riffle, nrow = 2) +
  labs(y = "Length (mm)", x = "Species")
```

How does the relationship of the median, mean, and range change between the two riffles? In other words, how does the size distribution change between the two riffles?

"Spectabile" has a similar range in both riffles, but a lower median in riffle 2. "Caeruleum" has a smaller range and lower median in riffle 2. "Blennioides" has a much larger range in riffle 2 and a slightly lower median. The mean is similar between rifles for all species.



Plot 2

Make a new plot with a geom_point() layer of length for each species
```{r}
ggplot(data = darters2, mapping = aes(x = species, y = length)) + 
  geom_point()
```

Change the point color to a lighter shade in the range of gray50 to gray70
```{r}
ggplot(data = darters2, mapping = aes(x = species, y = length)) + 
  geom_point(color = "gray50")
```

Add a stat_summary() layer with these arguments:
        fun.y = median
        geom = "point"
        size = 2.2
```{r}
ggplot(data = darters2, mapping = aes(x = species, y = length)) + 
  geom_point(color = "gray50") +
  stat_summary(
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median,
    geom = "point",
    size = 2.2
  ) 
```

 Add another stat_summary(). Change the y function to mean, size to 3, and add the color = "15"maroon" argument.
```{r}
ggplot(data = darters2, mapping = aes(x = species, y = length)) + 
  geom_point(color = "gray50") +
  stat_summary(
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median,
    geom = "point",
    size = 2.2
  ) +
  stat_summary(
    fun.ymin = min,
    fun.ymax = max,
    fun.y = mean,
    size = 3,
    geom = "point",
    color = "maroon"
  )
```
 
Facet, label, and flip the graph as you did above
```{r}
ggplot(data = darters2, mapping = aes(x = species, y = length)) + 
  geom_point(color = "gray50") +
  stat_summary(
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median,
    geom = "point",
    size = 2.2
  ) +
  stat_summary(
    fun.ymin = min,
    fun.ymax = max,
    fun.y = mean,
    size = 3,
    geom = "point",
    color = "maroon"
  ) +
  coord_flip() +
  facet_wrap(~ riffle, nrow = 2) +
  labs(y = "Length (mm)", x = "Species")
```



You probably noticed that the location of the median is not centered between the minimum and maximum values, even though the median is the middle value.

You decide that you could display the data more effectively. You want to show the individual measurements and emphasize the mean over the median. You also decide you want to try a slightly different way of graphing the data.

    Make a new plot with a geom_point() layer of length for each species. Change the point color to a lighter shade in the range of gray50 to gray70. The points should contrast against the overall gray background but they are not the main point of the graph.
    Add a stat_summary() layer with these arguments:
        fun.y = median
        geom = "point"
        size = 2.2
    Add another stat_summary(). Change the y function to mean, size to 3, and add the color = "15"maroon" argument.
    Facet, label, and flip the graph as you did above.

